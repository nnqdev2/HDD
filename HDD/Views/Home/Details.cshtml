@model HDD.Models.RetrofitApplicationDmvccddata


@{
    ViewData["Title"] = "Edit";

}



<form asp-action="Details" enctype="multipart/form-data" class="row g-3"  method="post">
    <div asp-validation-summary="ModelOnly" class="text-danger"></div>
    <div class="accordion" id="accordionPanelsStayOpenExample">
      <div class="accordion-item">
        <h2 class="accordion-header" id="panelsStayOpen-headingOne">
          <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseOne" aria-expanded="true" aria-controls="panelsStayOpen-collapseOne">
            @Model.Vin Customer Registration Information
          </button>
        </h2>
        <div id="panelsStayOpen-collapseOne" class="accordion-collapse collapse show" aria-labelledby="panelsStayOpen-headingOne">
          <div class="accordion-body">
            <div class="row g-3">
                <div class="form-floating col-md-6">
                    <input asp-for="Vin" class="form-control" disabled readonly />
                    <label asp-for="Vin" class="form-label"></label>
                </div>
                <div class="form-floating col-md-3">
                    <input asp-for="Plate" class="form-control" disabled readonly />
                    <label asp-for="Plate" class="form-label"></label>
                </div>		
                <div class="form-floating col-md-3">
                    <input asp-for="ModelYear" class="form-control" disabled readonly />
                    <label asp-for="ModelYear" class="form-label"></label>
                </div>
            </div>
		    <div class="row g-3">
                <div class="form-floating col-md-4">
                    <input asp-for="EngineYear" class="form-control" />
                    <label asp-for="EngineYear" class="form-label"></label>
                    <span asp-validation-for="EngineYear" class="text-danger"></span>
                </div>
                <div class="form-floating col-md-4">
                    <input asp-for="EngineManufacturer" class="form-control" />
                    <label asp-for="EngineManufacturer" class="form-label"></label>
                    <span asp-validation-for="EngineManufacturer" class="text-danger"></span>
                </div>
                <div class="form-floating col-md-4">
                    <input asp-for="Gvw" class="form-control" disabled readonly/>
                    <label asp-for="Gvw" class="form-label"></label>
                    <span asp-validation-for="Gvw" class="text-danger"></span>
                </div>
		    </div>
		    <div class="row g-3">
                <div class="form-floating col-md-6">
                    <input asp-for="EngineDisplacement" class="form-control" />
                    <label asp-for="EngineDisplacement" class="form-label"></label>
                    <span asp-validation-for="EngineDisplacement" class="text-danger"></span>
                </div>
                <div class="form-floating col-md-6">
                    <input asp-for="EngineFamilyNumber" class="form-control" />
                    <label asp-for="EngineFamilyNumber" class="form-label"></label>
                    <span asp-validation-for="EngineFamilyNumber" class="text-danger"></span>
                </div>
		    </div>
          </div>
        </div>
      </div>
      <div class="accordion-item">
        <h2 class="accordion-header" id="panelsStayOpen-headingTwo">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseTwo" aria-expanded="false" aria-controls="panelsStayOpen-collapseTwo">
            @Model.Vin Customer Information
          </button>
        </h2>
        <div id="panelsStayOpen-collapseTwo" class="accordion-collapse collapse" aria-labelledby="panelsStayOpen-headingTwo">
          <div class="accordion-body">
              <div class="form-floating col-12">
                <input asp-for="OwnerName" class="form-control form-control-sm" disabled readonly/>
                <label asp-for="OwnerName" class="form-label"></label>                
              </div>
              <div class="form-floating col-12">
                <input asp-for="StreetAddress" class="form-control form-control-sm" disabled readonly />
                <label asp-for="StreetAddress" class="form-label"></label>
              </div>
              <div class="row g-3">
                <div class="form-floating col-md-6">
                    <input asp-for="City" class="form-control form-control-sm" disabled readonly/>
                    <label asp-for="City" class="form-label"></label>
                </div>
                <div class="form-floating col-md-4">
                    <input asp-for="State" class="form-control form-control-sm" disabled readonly/>
                    <label asp-for="State" class="form-label"></label>
                </div>
                <div class="form-floating col-md-2">
                    <input asp-for="Zip" class="form-control form-control-sm" disabled readonly />
                    <label asp-for="Zip" class="form-label"></label>
                </div>
              </div>
              <div class="row g-3">
                <div class="form-floating col-md-4">
                    <input asp-for="County" class="form-control form-control-sm" disabled readonly/>
                    <label asp-for="County" class="form-label"></label>
                </div>
                <div class="form-floating col-md-4">
                    <input asp-for="RegistrationExpiration" class="form-control form-control-sm" disabled readonly/>
                    <label asp-for="RegistrationExpiration" class="form-label"></label>
                </div>
                <div class="form-floating col-md-4">
                    <input asp-for="PubliclyOwned" class="form-control form-control-sm" disabled readonly />
                    <label asp-for="PubliclyOwned" class="form-label"></label>
                </div>
            </div>
          </div>
        </div>
      </div>
      <div class="accordion-item">
        <h2 class="accordion-header" id="panelsStayOpen-headingThree">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseThree" aria-expanded="false" aria-controls="panelsStayOpen-collapseThree">
            @Model.Vin Customer Retrofit Application Information
          </button>
        </h2>
        <div id="panelsStayOpen-collapseThree" class="accordion-collapse collapse" aria-labelledby="panelsStayOpen-headingThree">
            <div class="accordion-body">
                <div class="row g-3">
                    <div class="form-floating col-md-6">
					    <input asp-for="ArtFamilyName" class="form-control required-field" />
                        <label asp-for="ArtFamilyName" class="form-label"></label>
					    <span asp-validation-for="ArtFamilyName" class="text-danger"></span>
				    </div>
				    <div class="form-floating col-md-6">
					    <input asp-for="RetrofitType" class="form-control" />
                        <label asp-for="RetrofitType" class="form-label"></label>
					    <span asp-validation-for="RetrofitType" class="text-danger"></span>
				    </div>			
			    </div>
                <div class="row g-3">
                    <div class="form-floating col-md-6">
					    <input asp-for="RetrofitProvider" class="form-control" />
                        <label asp-for="RetrofitProvider" class="form-label"></label>
					    <span asp-validation-for="RetrofitProvider" class="text-danger"></span>
				    </div>
				    <div class="form-floating col-md-6">
					    <input asp-for="ApplicationDate" class="form-control" />
                        <label asp-for="ApplicationDate" class="form-label"></label>
					    <span asp-validation-for="ApplicationDate" class="text-danger"></span>
				    </div>
			    </div>
                <div class="form-floating col-12">
                    <input asp-for="Comments" class="form-control" />
                    <label asp-for="Comments" class="form-label"></label>
                    <span asp-validation-for="Comments" class="text-danger"></span>
                </div>  
                <div class="form-floating col-12">
                <div id="uploadHelp" class="form-text" style="color:red">**Rick's document mentioned Installation Date.  Do we need to add Installation date to RetrofitApplication table?**</div>
                </div>
            </div>
        </div>
      </div>
      <div class="accordion-item">
        <h2 class="accordion-header" id="panelsStayOpen-headingThree1">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseThree1" aria-expanded="false" aria-controls="panelsStayOpen-collapseThree1">
            @Model.Vin Customer Retrofit Application Documents Submitted
          </button>
        </h2>
        <div id="panelsStayOpen-collapseThree1" class="accordion-collapse collapse" aria-labelledby="panelsStayOpen-headingThree1">
          <div class="accordion-body">
            <table class="table table-bordered table-hover" >
            @*<table class="table table-bordered table-hover" style="width:100%">*@
	            <thead>
		            <tr>
			            @*<th>VIN</th>*@
			            <th>Document Name</th>
                        <th>Document Type</th>
                        <th>Certification year</th>
                        <th>Uploaded By</th>
                        <th>Uploaded Date</th>
@*			            <th>File Path</th>*@
			            <th data-bs-toggle="tooltip" data-bs-placement="top" title="Will be grayed out/not visible when VINStatus = Pending Cert/Certified.">Mark for Delete</th>
		            </tr>
	            </thead>
	            <tbody>
                    @if (Model.DocumentActions.Count() > 0)
                    {
                        @foreach(var obj in Model.DocumentActions)
		                {
			                <tr>
				                @*<td >@obj.Vin</td>*@
				                <td ><a href="https://deqtoo.org" target="_blank">@obj.DocumentName</a></td>
                                <td width="10%">Pre-installation Compatibility Assessment</td>
                                <td width="10%">2020</td>
                                <td width="10%">nga.quan@deq.oregon.gov</td>
                                <td width="10%">2020/09/10</td>
				                <td>
                                    <div class="form-check">
                                      <input class="form-check-input" type="checkbox" value="" id="@obj.IsDelete">
@*                                      <label class="form-check-label" for="flexCheckDefault">
                                        Default checkbox
                                      </label>*@
                                    </div>
                                </td>
			                </tr>
                        }
                    }
                    else
                    {
                        <tr>
                        <td >No documents submitted</td>
                        </tr>
                    }

			
	            </tbody>
            </table>    
            </div>
        </div>
      </div>
      <div class="accordion-item">
        <h2 class="accordion-header" id="panelsStayOpen-headingFour">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseFour" aria-expanded="false" aria-controls="panelsStayOpen-collapseFour">
            @Model.Vin Customer Retrofit Application Document Uploads  <span style="color: red"> &nbsp; &nbsp;** Owners can always upload documents regardless of the VIN status.  **</span>
          </button>
        </h2>
        <div id="panelsStayOpen-collapseFour" class="accordion-collapse collapse" aria-labelledby="panelsStayOpen-headingFour">
          <div class="accordion-body">
            <div class="row g-3">
                <div class="form-group col-md-4">
                    <select class="form-select form-select-lg mb-3 col-md-4" aria-label=".form-select-lg example">
                    @*<select data-val="true" data-val-required="The DayOfWeek field is required." id="DayOfWeek" name="DayOfWeek">*@
                        <option value="">Select a certification year</option>
                        <option value="0">2020</option>
                        <option value="1">2021</option>
                        <option value="2">2022</option>
                    </select>
                    <div id="uploadHelp" class="form-text" style="color:red">Need a reference table for certification years</div>
                </div>
                <div class="form-group col-md-4">
                    <select class="form-select form-select-lg mb-3 col-md-4" aria-label=".form-select-lg example">
                    @*<select data-val="true" data-val-required="The DayOfWeek field is required." id="DayOfWeek" name="DayOfWeek">*@
                        <option value="">Select a document type</option>
                        <option value="0">Approved Retrofit Identification Label</option>
                        <option value="1">Pre-installation Compatibility Assessment</option>
                        <option value="2">Warranty Registration Form</option>
                        <option value="3">Owner Testimony Form</option>
                        <option value="4">Annual Inspection Form</option>
                        <option value="5">Others</option>
                    </select>
                    <div id="uploadHelp" class="form-text" style="color:red">Need a reference table for document types</div>
                </div>
            </div>
             <div class="mb-3">
              <label for="formFile" class="form-label">Select Document to Upload</label>
              <input class="form-control" type="file" id="formFile" onchange="FileDetails()">
              <div id="uploadHelp" class="form-text" style="color:red">Acceptable file types are jpegs and pdfs. Is this correct?</div>
            </div>
    <!--SHOW RESULT HERE-->
            <div class="mb-3">
                <p id="fp"></p>
            </div>
            <script>
                function FileDetails() {

                    // GET THE FILE INPUT.
                    var fi = document.getElementById('formFile');

                    //alert ("fi ====> "+fi);

                    // VALIDATE OR CHECK IF ANY FILE IS SELECTED.
                    if (fi.files.length > 0) {
                        if (fi.files.length > 6) {
                            alert ('Max number of documents uploaded each time is 6.')
                        }

                        // THE TOTAL FILE COUNT.
                        //document.getElementById('fp').innerHTML =
                        //    'Total Files: <b>' + fi.files.length + '</b></br >';

                        // RUN A LOOP TO CHECK EACH SELECTED FILE.
                        for (var i = 0; i <= fi.files.length - 1; i++) {

                            var fname = fi.files.item(i).name;      // THE NAME OF THE FILE.
                            var fsize = fi.files.item(i).size;      // THE SIZE OF THE FILE.

                            // SHOW THE EXTRACTED DETAILS OF THE FILE.
                            document.getElementById('fp').innerHTML =
                                document.getElementById('fp').innerHTML + '<br /> ' +
                                    fname + ' (<b>' + fsize + '</b> bytes)';
                        }
                    }
                    else { 
                        alert('Please select a file.') 
                    }

                    //alert ("this is the end ..."+fi);
                }
            </script>
            <div class="input-group-append">
              <button class="btn btn-primary" type="button" id="customFileInput">Upload</button>
            </div>

          </div>
        </div>





      <div class="accordion-item">
        <h2 class="accordion-header" id="panelsStayOpen-headingAction">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseAction" aria-expanded="false" aria-controls="panelsStayOpen-collapseAction">
            @Model.Vin ACTION 
          </button>
        </h2>
        <div id="panelsStayOpen-collapseAction" class="accordion-collapse collapse" aria-labelledby="panelsStayOpen-headingAction">
          <div class="accordion-body">
@*<div class="row btn-group" role="button">*@
                <a asp-action="Save" asp-route-id="@Model.Vin" class="btn btn-primary mx-2">
                <i class="bi bi-pencil-square"  data-bs-toggle="tooltip" data-bs-placement="top" title="not visible or grayed out when VIN status is in Pending Cert/Certified status.  No Validations done.  Emails sent to all owners. ">Save</i>
                </a>
                <a asp-action="Submit" asp-route-id="@Model.Vin"  class="btn btn-primary mx-2">
                <i class="bi bi-pencil-square" data-bs-toggle="tooltip" data-bs-placement="top" title="not visible or grayed out when VIN status is in Pending Cert/Certified status.  Validation required here.  Emails sent to all owners and VIP staff.  Update RetrofitCertification.VINstatus to Pending Review when all validations pass. ">Submit</i>
                </a>
                <a asp-action="Unclaim" asp-route-id="@Model.Vin"  class="btn btn-danger mx-2">
                <i class="bi bi-trash-fill"  data-bs-toggle="tooltip" data-bs-placement="top" title="For Primary Owner eyes only.  Can owner unclaim the vin when vin status is pending cert/certified? " >UnClaim @Model.Vin </i>
                </a>
@*</div>*@
          </div>
        </div>
      </div>



      </div>
    </div>
</form>


<div>
    <a asp-action="Index">Back to your Vins list</a>
</div>


@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}



<script>
var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
  return new bootstrap.Tooltip(tooltipTriggerEl)
})
</script>

<script>
function buttonA_clickHandler() {
    alert('scooby doo where are you????');
    document.getElementById('SubmissionStatus').value = "VehicleInfo";
    document.getElementById('VehicleInfoForm').submit();
}
</script>

}